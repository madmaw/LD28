var ct;!function(a){function b(a){var b=document.getElementById(a).innerHTML;return Handlebars.compile(b)}window.onload=function(){Handlebars.registerHelper("math",function(a,b,c,d){return arguments.length<4&&(d=c,c=b,b="+"),a=parseFloat(a),c=parseFloat(c),console.log(d),{"+":a+c,"-":a-c,"*":a*c,"/":a/c,"%":a%c}[b]});var c=new a.core.SoundEffect(["click-1","click-2","click-3","click-4"]),d=new a.core.SoundEffect(["whoosh-1","whoosh-2","whoosh-3"]),e=[new a.core.SoundEffect([]),new a.core.SoundEffect([]),new a.core.SoundEffect(["extol-1","",""]),new a.core.SoundEffect(["extol-2","",""]),new a.core.SoundEffect(["extol-3","",""]),new a.core.SoundEffect(["extol-3",""]),new a.core.SoundEffect(["extol-4","",""]),new a.core.SoundEffect(["extol-4",""]),new a.core.SoundEffect(["extol-5","",""]),new a.core.SoundEffect(["extol-5",""]),new a.core.SoundEffect(["extol-6","",""]),new a.core.SoundEffect(["extol-5",""])],f=new a.core.SoundEffect(["invalid-1","invalid-2"]),g=6,h=Math.floor(window.innerWidth/g),i=Math.floor(window.innerHeight/Math.floor(window.innerHeight/h)),j=Math.floor(window.innerHeight/i);5>j&&(j=5,i=Math.floor(window.innerHeight/j),g=Math.floor(window.innerWidth/i),h=Math.floor(window.innerWidth/g));var k=i;j--;var l=new a.core.board.FairTileSource(.3,[new a.core.board.value.ValueNumeric(1)],[[new a.core.board.value.ValueFunctionAddition]],0),m=(new a.core.board.FairTileSource(.3,[new a.core.board.value.ValueNumeric(1)],[[new a.core.board.value.ValueFunctionAddition]],0),new a.core.board.FairTileSource(.3,[new a.core.board.value.ValueNumeric(0)],[[new a.core.board.value.ValueFunctionIncrement,new a.core.board.value.ValueFunctionDecrement],[new a.core.board.value.ValueFunctionAddition,new a.core.board.value.ValueFunctionSubtraction],[new a.core.board.value.ValueFunctionMultiplication]],1)),n=new a.core.board.FairTileSource(.25,[new a.core.board.value.ValueNumeric(0),new a.core.board.value.ValueNumeric(1)],[[new a.core.board.value.ValueFunctionAddition,new a.core.board.value.ValueFunctionSubtraction],[new a.core.board.value.ValueFunctionIncrement,new a.core.board.value.ValueFunctionDecrement],[new a.core.board.value.ValueFunctionMultiplication,new a.core.board.value.ValueFunctionAccumulate]],2,[new a.core.board.value.ValueFunctionAccumulate]),o=new a.core.board.FairTileSource(.25,[new a.core.board.value.ValueNumeric(0),new a.core.board.value.ValueNumeric(1)],[[new a.core.board.value.ValueFunctionAddition,new a.core.board.value.ValueFunctionSubtraction],[new a.core.board.value.ValueFunctionIncrement,new a.core.board.value.ValueFunctionDecrement],[new a.core.board.value.ValueFunctionMultiplication,new a.core.board.value.ValueFunctionAddTime]],2,[new a.core.board.value.ValueFunctionAddTime]),p=new a.core.board.FairTileSource(.4,[new a.core.board.value.ValueNumeric(-1),new a.core.board.value.ValueNumeric(1)],[[new a.core.board.value.ValueFunctionAddition,new a.core.board.value.ValueFunctionSubtraction],[new a.core.board.value.ValueFunctionIncrement,new a.core.board.value.ValueFunctionDecrement]],2,[new a.core.board.value.ValueFunctionMultiplication]),q=new a.core.board.PointsSourceBoardValue,r=(new a.core.board.PointsSourceMaxBoardValue,new a.core.board.PointsSourceAccumulated),s=new a.core.board.PointSourceTime,t=new a.core.board.PointSourceZero,u=[];u.push(new a.core.home.Level("f2p","You Only Get One(s)","Back button exits",!1,function(b){for(var c=0,d=new a.core.board.Board(g,j,h,i),e=l.create(g*j,1),f=[],k=0;k<d.tilesAcross;k++)for(var m=0;m<d.tilesDown;m++){var n=e[c];c++,n.board=d;var o=new a.core.board.action.ActionDropTile(n,k,m-d.tilesDown,m);f.push(o)}f.push(new a.core.board.action.ActionScoreUpdated);var p=new a.core.board.BoardGameState(b,d,l,q);return{gameState:p,actions:f}})),u.push(new a.core.home.Level("scant","Scant Rewards","",!0,function(b){for(var c=0,d=new a.core.board.Board(g,j,h,i),e=m.create(g*j,10),f=[],k=0;k<d.tilesAcross;k++)for(var l=0;l<d.tilesDown;l++){var n=e[c];c++,n.board=d;var o=new a.core.board.action.ActionDropTile(n,k,l-d.tilesDown,l);f.push(o)}f.push(new a.core.board.action.ActionScoreUpdated);var p=new a.core.board.BoardGameState(b,d,m,q);return{gameState:p,actions:f}})),u.push(new a.core.home.Level("acc","Accumulater","*(acc)umulate score",!0,function(b){for(var c=0,d=new a.core.board.Board(g,j,h,i),e=n.create(g*j,1),f=[],k=0;k<d.tilesAcross;k++)for(var l=0;l<d.tilesDown;l++){var m=e[c];c++,m.board=d;var o=new a.core.board.action.ActionDropTile(m,k,l-d.tilesDown,l);f.push(o)}f.push(new a.core.board.action.ActionScoreUpdated);var p=new a.core.board.BoardGameState(b,d,n,r);return{gameState:p,actions:f}})),u.push(new a.core.home.Level("timer","Count Down","first move starts timer",!0,function(b){for(var c=0,d=new a.core.board.Board(g,j,h,i),e=m.create(g*j,1),f=[],k=d.tilesAcross;k>0;){k--;for(var l=d.tilesDown;l>0;){l--;var n=e[c];c++,n.board=d;var o=new a.core.board.action.ActionDropTile(n,k,l-d.tilesDown,l);f.push(o)}}f.push(new a.core.board.action.ActionScoreUpdated);var p=new a.core.board.BoardGameState(b,d,m,q,12e4);return{gameState:p,actions:f}})),u.push(new a.core.home.Level("tacc","Timed Accumulater","",!0,function(b){for(var c=0,d=new a.core.board.Board(g,j,h,i),e=n.create(g*j,1),f=[],k=0;k<d.tilesAcross;k++)for(var l=0;l<d.tilesDown;l++){var m=e[c];c++,m.board=d;var o=new a.core.board.action.ActionDropTile(m,k,l-d.tilesDown,l);f.push(o)}f.push(new a.core.board.action.ActionScoreUpdated);var p=new a.core.board.BoardGameState(b,d,n,r,12e4);return{gameState:p,actions:f}})),u.push(new a.core.home.Level("alive","Stayin' Alive","time is score",!0,function(b){for(var c=0,d=new a.core.board.Board(g,j,h,i),e=o.create(g*j,1),f=[],k=0;k<d.tilesAcross;k++)for(var l=0;l<d.tilesDown;l++){var m=e[c];c++,m.board=d;var n=new a.core.board.action.ActionDropTile(m,k,l-d.tilesDown,l);f.push(n)}f.push(new a.core.board.action.ActionScoreUpdated);var p=new a.core.board.BoardGameState(b,d,o,s,12e4);return{gameState:p,actions:f}})),u.push(new a.core.home.Level("zero","Zero out","make zero value",!0,function(b){for(var c=0,d=new a.core.board.Board(g,j,h,i),e=p.create(g*j,1),f=[],k=0;k<d.tilesAcross;k++)for(var l=0;l<d.tilesDown;l++){var m=e[c];c++,m.board=d;var n=new a.core.board.action.ActionDropTile(m,k,l-d.tilesDown,l);f.push(n)}f.push(new a.core.board.action.ActionScoreUpdated);var o=new a.core.board.BoardGameState(b,d,p,t);return o.replaceTiles=!1,{gameState:o,actions:f}}));var v=new a.core.home.HomeGameState(u),w=new a.core.render.board.BoardGameStateRenderer(b("board"),{headerHeight:k,windowWidth:window.innerWidth,windowHeight:window.innerHeight},window.location.pathname,k,v,e,d,f),x=new a.core.render.home.HomeGameStateRenderer(b("home"),{},window.location.pathname,window.innerWidth,window.innerHeight),y=b("tile");Handlebars.registerPartial("tile",y);var z=b("animate-action-drop"),A=b("animate-attribute"),B=b("animate-grow"),C=null,D=function(b,d){var e=null;e=b instanceof a.core.board.BoardGameState?w:x;var f=document.getElementById("content");null!=C&&C.stop(),C=e.render(b,f);var g=new a.core.render.HardcodedActionRendererFactory("#DDDDDD","#BBFFBB","#FFBBBB","#BBBBFF","#888888",y,A,B,z,c);for(var h in d){var i=d[h];i.perform(b);var j=g.getActionRenderer(i);j.render(i,b,f,!0)}C.start(function(a){var c=!1;for(var d in a){var e,h=a[d],i=h.perform(b);if(null!=i){var j=i.gameState,k=i.actions;if(j!=b&&null!=j)c||(e=function(){D(j,k)},c=!0);else for(var l in k){var m=k[l];a.push(m)}}var n=g.getActionRenderer(h);null!=n?n.render(h,b,f,!0,e):null!=e&&e()}})},E=function(a){null!=a&&a.length>0&&"#"==a.charAt(0)&&(a=a.substring(1));var b,c,d=null;for(var e in u){var f=u[e];if(f.id==a){d=f;break}}if(null!=d){var g=d.gameStateFactory(d);b=g.gameState,c=g.actions}else b=v,c=[];D(b,c)};window.onhashchange=function(){var a=window.location.hash;E(a)},E(window.location.hash)}}(ct||(ct={}));var ct;!function(a){!function(a){var b=function(){function a(a,b){this.x=a,this.y=b}return a}();a.Point=b}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){var b=function(){function a(a){this.audioIds=a,this.playCount=0,this.inUse={}}return a.prototype.play=function(){var a=this;this.playCount>0?window.setTimeout(function(){a.forcePlay()},100*this.playCount*Math.random()):this.forcePlay()},a.prototype.forcePlay=function(){var a=this;if(this.audioIds.length>0){var b=Math.floor(Math.random()*this.audioIds.length),c=this.audioIds[b];if(!this.inUse[c]){this.playCount++,this.inUse[c]=!0;var d=document.getElementById(c);if(null!=d){var e=d;e.addEventListener("ended",function(){a.playCount--,a.inUse[c]=!1}),e.play()}}}},a}();a.SoundEffect=b}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){var b=function(){function a(b,c,d,e){this.tilesAcross=b,this.tilesDown=c,this.tileWidth=d,this.tileHeight=e,this.id="board-"+a._boardId,a._boardId++,this.tiles=new Array;for(var f=0;b>f;f++){for(var g=new Array,h=0;c>h;h++)g.push(null);this.tiles.push(g)}}return a.prototype.setTile=function(a,b,c){a.position.x=b,a.position.y=c,a.board=this,this.tiles[b][c]=a},a._boardId=0,a}();a.Board=b}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e){this.level=a,this.board=b,this.tileSource=c,this.pointsSource=d,this.gameplayMilliseconds=e,this.selectedTileChain=[],this.startTime=null,this.accumulatedPoints=0,this.replaceTiles=!0}return a.prototype.getId=function(){return this.level.id},a.prototype.getName=function(){return this.level.name},Object.defineProperty(a.prototype,"millisecondsRemaining",{get:function(){var a;return a=null!=this.gameplayMilliseconds?null!=this.startTime?this.gameplayMilliseconds-((new Date).getTime()-this.startTime.getTime()):this.gameplayMilliseconds:null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"secondsRemainingFormatted",{get:function(){var a=this.millisecondsRemaining;return this.getSecondsRemainingFormatted(a)},enumerable:!0,configurable:!0}),a.prototype.getSecondsRemainingFormatted=function(a){var b;if(null!=a){var c=a/1e3,d=Math.floor(c/60);c%=60,b=""+c;var e=b.indexOf(".");if(0>e?(e=b.length,b+=".0"):b=b.substring(0,e+2),d>0){for(;2>e;)b="0"+b,e++;b=""+d+":"+b}}else b=null;return b},a.prototype.getAccumulatedPoints=function(){return 0},a}();a.BoardGameState=b}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(a,b,c,d,e){this.fairRatio=a,this.normalValues=b,this.symbolValues=c,this.cruelty=d,this.guaranteedSymbolValues=e}return b.prototype.create=function(a,b){null==b&&(b=0);var c=Math.floor(a*this.fairRatio);return this.createQuantity(a-c,c,b,!1)},b.prototype.createQuantity=function(b,c,d,e){for(var f=[],g=0;b>g;g++){var h=Math.abs(2*this.rand(d)-1),i=Math.floor(h*this.normalValues.length),j=this.normalValues[i],k=new a.core.board.Tile(j);f.push(k)}if(null!=this.guaranteedSymbolValues&&!e)for(var l in this.guaranteedSymbolValues){var j=this.guaranteedSymbolValues[l],k=new a.core.board.Tile(j),m=Math.floor(Math.random()*f.length);f.splice(m,0,k)}for(var g=0;c>g;g++){var h=Math.abs(2*this.rand(d)-1),i=Math.floor(h*this.symbolValues.length),m=Math.floor(Math.random()*f.length),n=this.symbolValues[i],o=Math.floor(Math.random()*n.length),j=n[o],k=new a.core.board.Tile(j);f.splice(m,0,k)}return f},b.prototype.replace=function(b,c){for(var d=b.tilesAcross*b.tilesDown-c.length,e=0,f=this.cruelty,g=0;g<b.tilesAcross;g++)for(var h=0;h<b.tilesDown;h++){var i=b.tiles[g][h];c.indexOf(i)<0&&(i.value instanceof a.core.board.value.ValueNumeric||e++)}for(var j=e/d,k=0,l=0;l<c.length;l++){var m=this.rand(this.cruelty);2*m*j<this.fairRatio&&k++}return this.createQuantity(Math.max(c.length-k,0),k,Math.max(f,0),!0)},b.prototype.rand=function(a){for(var b=Math.random(),c=0;a>c;c++)b+=Math.random();return b/(a+1)},b}();b.FairTileSource=c}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){var b=function(){function a(){this.name="accumulated"}return a.prototype.getPoints=function(a){return a.accumulatedPoints},a}();a.PointsSourceAccumulated=b}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(){this.name="maximum value"}return b.prototype.getPoints=function(b){for(var c=null,d=b.board,e=0;e<d.tilesAcross;e++)for(var f=0;f<d.tilesDown;f++){var g=d.tiles[e][f];if(g.value instanceof a.core.board.value.ValueNumeric){var h=g.value,i=h.value;c=null==c?i:Math.max(c,i)}}return c},b}();b.PointsSourceMaxBoardValue=c}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){var b=function(){function a(){this.name="time"}return a.prototype.getPoints=function(a){var b,c=a.startTime;return b=null!=c?Math.floor(((new Date).getTime()-c.getTime())/1e3):0},a}();a.PointSourceTime=b}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(){this.name="zero"}return b.prototype.getPoints=function(b){for(var c=0,d=b.board,e=0;e<d.tilesAcross;e++)for(var f=0;f<d.tilesDown;f++){var g=d.tiles[e][f];if(null!=g&&g.value instanceof a.core.board.value.ValueNumeric){var h=g.value;c+=h.value}}return-Math.abs(c)},b}();b.PointSourceZero=c}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(){this.name="board value"}return b.prototype.getPoints=function(b){for(var c=0,d=b.board,e=0;e<d.tilesAcross;e++)for(var f=0;f<d.tilesDown;f++){var g=d.tiles[e][f];if(null!=g&&g.value instanceof a.core.board.value.ValueNumeric){var h=g.value;c+=h.value}}return c},b}();b.PointsSourceBoardValue=c}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(c){this.value=c,this.id="tile-"+b._tileId,b._tileId++,this.position=new a.core.Point,this.symbol=c.toString(),this.selectionState=0}return b._tileId=0,b}();b.Tile=c}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){a[a.UNSELECTED=0]="UNSELECTED",a[a.INVALID=1]="INVALID",a[a.VALID=2]="VALID",a[a.EXTRANEOUS=3]="EXTRANEOUS",a[a.BAD_PARAMETER=4]="BAD_PARAMETER"}(a.TileSelectionState||(a.TileSelectionState={}));a.TileSelectionState}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){this.tile=a,this.x=b,this.y=c,a.position.x=b,a.position.y=c}return a.prototype.getPrimaryId=function(){return this.tile.id},a.prototype.perform=function(a){var b=a,c=b.board;return c.setTile(this.tile,this.x,this.y),null},a}();a.ActionCreateTile=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){this.tile=a}return a.prototype.getPrimaryId=function(){return this.tile.id},a.prototype.perform=function(a){var b=a,c=b.selectedTileChain.indexOf(this.tile);return c>=0&&b.selectedTileChain.splice(c,1),this.tile.selectionState=0,null},a}();a.ActionDeselectTile=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){this.tile=a}return a.prototype.getPrimaryId=function(){return this.tile.id},a.prototype.perform=function(a){var b=a,c=b.board,d=this.tile.position;return c.tiles[d.x][d.y]=null,null},a}();a.ActionDestroyTile=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d){this.tile=a,this.column=b,this.fromRow=c,this.toRow=d,this.dRow=d-c}return a.prototype.getPrimaryId=function(){return this.tile.id},a.prototype.perform=function(a){var b=a,c=b.board;return this.fromRow>=0&&c.tiles[this.column][this.fromRow]==this.tile&&(c.tiles[this.column][this.fromRow]=null),c.setTile(this.tile,this.column,this.toRow),null},a}();a.ActionDropTile=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b){this.score=a,this.boardGameState=b}return a.prototype.getPrimaryId=function(){return this.boardGameState.board.id},a.prototype.perform=function(a){var b=a;return b.accumulatedPoints+=this.score,null},a}();a.ActionScoreAccumulated=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){}return a.prototype.getPrimaryId=function(){return null},a.prototype.perform=function(a){var b=a,c=b.pointsSource.getPoints(b);return b.level.highScore=null==b.level.highScore?c:Math.max(c,b.level.highScore),null},a}();a.ActionScoreUpdated=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b){this.tile=a,this.newSelectionState=b,this.originalSelectionState=a.selectionState}return a.prototype.getPrimaryId=function(){return this.tile.id},a.prototype.perform=function(){return this.tile.selectionState=this.newSelectionState,null},a}();a.ActionSetTileSelectionState=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b.prototype.perform=function(b){var c=b,d=c.selectedTileChain;return d.push(this.tile),a.prototype.perform.call(this,b)},b}(a.core.board.action.ActionSetTileSelectionState);b.ActionSelectTile=c}(b.action||(b.action={}));b.action}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e){this.secondsRemainingFormatted=a,this.boardGameState=b,this.bonusTime=c,this.startTime=d,this.gameState=e}return a.prototype.getPrimaryId=function(){return this.boardGameState.board.id},a.prototype.perform=function(a){var b=a;return this.bonusTime&&(b.gameplayMilliseconds+=this.bonusTime),this.startTime&&(b.startTime=this.startTime),{gameState:this.gameState,actions:[]}},a}();a.ActionTimeRemainingUpdated=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(){function b(a,b,c){this.evalReturnsNumber=a,this.numberOfParams=b,this.stringRepresentation=c}return b.prototype.eval=function(){return null},b.prototype.terminate=function(b,c,d){var e=b[b.length-1],f=new a.core.board.Tile(new a.core.board.value.ValueNumeric(d));return[new a.core.board.action.ActionCreateTile(f,e.position.x,e.position.y)]},b.prototype.toString=function(){return this.stringRepresentation},b}();b.AbstractValue=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!0,1,"abs")}return __extends(b,a),b.prototype.eval=function(a){return Math.abs(a[0])},b}(a.core.board.value.AbstractValue);b.ValueFunctionAbs=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(b){function c(){b.call(this,!1,1,"acc")}return __extends(c,b),c.prototype.eval=function(a){return a[0]},c.prototype.terminate=function(b,c,d){return[new a.core.board.action.ActionScoreAccumulated(d,c)]},c}(a.core.board.value.AbstractValue);b.ValueFunctionAccumulate=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(b){function c(){b.call(this,!1,1,"tim")}return __extends(c,b),c.prototype.eval=function(a){return a[0]},c.prototype.terminate=function(b,c,d){var e=c.millisecondsRemaining;null!=e&&(e+=1e4*d);var f=c.getSecondsRemainingFormatted(e);return[new a.core.board.action.ActionTimeRemainingUpdated(f,c,1e3*d)]},c}(a.core.board.value.AbstractValue);b.ValueFunctionAddTime=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!0,2,"+")}return __extends(b,a),b.prototype.eval=function(a){var b=0;for(var c in a){var d=a[c];b+=d}return b},b}(a.core.board.value.AbstractValue);b.ValueFunctionAddition=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!0,1,"--")}return __extends(b,a),b.prototype.eval=function(a){return a[0]-1},b}(a.core.board.value.AbstractValue);b.ValueFunctionDecrement=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!1,1,"kil")}return __extends(b,a),b.prototype.eval=function(a){return a[0]},b}(a.core.board.value.AbstractValue);b.ValueFunctionDestroy=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!0,1,"++")}return __extends(b,a),b.prototype.eval=function(a){return a[0]+1},b}(a.core.board.value.AbstractValue);b.ValueFunctionIncrement=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!0,2,"*")}return __extends(b,a),b.prototype.eval=function(a){var b=1;for(var c in a){var d=a[c];b*=d}return b},b}(a.core.board.value.AbstractValue);b.ValueFunctionMultiplication=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!0,1,"neg")}return __extends(b,a),b.prototype.eval=function(a){return-a[0]},b}(a.core.board.value.AbstractValue);b.ValueFunctionNegate=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(){a.call(this,!0,2,"-")}return __extends(b,a),b.prototype.eval=function(a){for(var b=a[0],c=1;c<a.length;c++){var d=a[c];b-=d}return b},b}(a.core.board.value.AbstractValue);b.ValueFunctionSubtraction=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(b){a.call(this,!0,0,""+b),this.value=b}return __extends(b,a),b.prototype.eval=function(){return this.value},b}(a.core.board.value.AbstractValue);b.ValueNumeric=c}(b.value||(b.value={}));b.value}(b.board||(b.board={}));b.board}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){var b=function(){function a(a){this.levels=a}return a.prototype.getId=function(){return""},a.prototype.getName=function(){return"Code Tower"},a}();a.HomeGameState=b}(a.home||(a.home={}));a.home}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(b,c,d,e,f){this.id=b,this.name=c,this.description=d,this.locked=e,this.gameStateFactory=f,this.highScore=null,this.position=new a.core.Point}return b}();b.Level=c}(b.home||(b.home={}));b.home}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){this.level=a}return a.prototype.getPrimaryId=function(){return this.level.id},a.prototype.perform=function(){return this.level.gameStateFactory(this.level)},a}();a.ActionLevelSelect=b}(a.action||(a.action={}));a.action}(a.home||(a.home={}));a.home}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(a,b,c){this.template=a,this.params=b,this.baseUrl=c}return b.prototype.render=function(a,b){this.params.gameState=a,this.doRender(a,b,this.params);var c=a.getId();return window.history.pushState(c,a.getName(),this.baseUrl+"#"+c),null},b.prototype.doRender=function(b,c,d){for(;c.firstChild;)c.removeChild(c.firstChild);var e=this.template(d),f=a.core.render.HandlebarsSVGAnimationActionRenderer.parseSVG(e);for(var g in f){var h=f[g];c.appendChild(h)}},b}();b.HandlebarsGameStateRenderer=c}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){var b=function(){function a(a,b){this.template=a,this.params=b}return a.prototype.render=function(b,c,d,e,f){var g=this,h=this.findOrCreateTarget(b,c,d);if(e){var i="anim-"+a._animationId;a._animationId++,this.params.gameState=c,this.params.action=b,this.params.animationId=i,this.adjustParams(b,c,this.params);var j=this.template(this.params),k=a.parseSVG(j),l=0;for(var m in k){var n=k[m];console.log("animating "+n.tagName),n.addEventListener("endEvent",function(){g.setToFinalState(b,c,h),h.removeChild(n),l++,l==k.length&&(g.onCompletion(!0),f&&f(b,c))}),h.appendChild(n),n.beginElement()}}else this.setToFinalState(b,c,h),this.onCompletion(!1),f&&f(b,c)},a.prototype.onCompletion=function(){},a.prototype.adjustParams=function(){},a.prototype.setToFinalState=function(){},a.prototype.findOrCreateTarget=function(a,b,c){return c},a.parseSVG=function(a,b){var c=document.createElementNS("http://www.w3.org/1999/xhtml","div");c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+a+"</svg>";var d=[];for(var e in c.childNodes){var f=c.childNodes[e];for(var g in f.childNodes){var h=f.childNodes[g];null==h.tagName||null!=b&&h.getAttribute("id")!=b||d.push(h)}}return d},a._animationId=0,a}();a.HandlebarsSVGAnimationActionRenderer=b}(a.render||(a.render={}));a.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(a){function b(b,c,d,e,f,g,h){a.call(this,b,g),this.attributeName=c,this.startValue=d,this.endValue=e,this.idPostfix=f,this.removeAllWhenDone=h}return __extends(b,a),b.prototype.adjustParams=function(a,b,c){c.from=this.startValue,c.to=this.endValue,c.attributeName=this.attributeName},b.prototype.setToFinalState=function(a,b,c){{var d=b;d.board}c.setAttribute(this.attributeName,this.endValue),this.removeAllWhenDone&&c.parentNode&&c.parentNode.removeChild(c)},b.prototype.findOrCreateTarget=function(a,b){var c=b,d=(c.board,a.getPrimaryId()+this.idPostfix),e=document.getElementById(d);return e},b}(a.core.render.HandlebarsSVGAnimationActionRenderer);b.HandlebarsSVGAnimationAttributeActionRenderer=c}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){var c=function(){function b(b,c,d,e,f,g,h,i,j,k){this.selectTileActionRenderer=new a.core.render.board.HandlebarsSVGAnimationActionSetTileSelectionStateRenderer(h,b,c,d,e,f,"-bg",{}),this.dropTileActionRenderer=new a.core.render.board.HandlebarsSVGAnimationActionDropTileRenderer(j,g,b,k,{}),this.destroyTileActionRenderer=new a.core.render.HandlebarsSVGAnimationAttributeActionRenderer(i,"opacity","1","0","-container",{},!0),this.createTileActionRenderer=new a.core.render.board.HandlebarsSVGAnimationActionCreateTileRenderer(h,g,b,{}),this.actionTimeRemainingUpdatedRenderer=new a.core.render.board.action.ActionTimeRemainingUpdatedRenderer,this.actionUpdatePointsRenderer=new a.core.render.board.action.ActionUpdatePointsRenderer}return b.prototype.getActionRenderer=function(b){var c;return c=b instanceof a.core.board.action.ActionDeselectTile||b instanceof a.core.board.action.ActionSelectTile||b instanceof a.core.board.action.ActionSetTileSelectionState?this.selectTileActionRenderer:b instanceof a.core.board.action.ActionDropTile?this.dropTileActionRenderer:b instanceof a.core.board.action.ActionCreateTile?this.createTileActionRenderer:b instanceof a.core.board.action.ActionDestroyTile?this.destroyTileActionRenderer:b instanceof a.core.board.action.ActionTimeRemainingUpdated?this.actionTimeRemainingUpdatedRenderer:b instanceof a.core.board.action.ActionScoreUpdated||b instanceof a.core.board.action.ActionScoreAccumulated?this.actionUpdatePointsRenderer:null},b}();b.HardcodedActionRendererFactory=c}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){}return a.prototype.render=function(a,b,c,d,e){var f=a,g=b,h=g.board,i=document.getElementById(h.id+"-time");i.textContent=f.secondsRemainingFormatted,e&&e()},a}();a.ActionTimeRemainingUpdatedRenderer=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.render||(a.render={}));a.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){}return a.prototype.render=function(a,b,c,d,e){var f=b,f=b,g=f.board,h=f.pointsSource.getPoints(f),i=document.getElementById(g.id+"-score");i.textContent=""+h,e&&e()},a}();a.ActionUpdatePointsRenderer=b}(a.action||(a.action={}));a.action}(a.board||(a.board={}));a.board}(a.render||(a.render={}));a.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(){function b(a,b,c,d,e,f,g){this.gameState=a,this.homeGameState=b,this.div=c,this.headerHeight=d,this.extols=e,this.claim=f,this.invalid=g,this.mouseDown=!1}return b.prototype.countDown=function(b){var c=this,d=this.gameState.millisecondsRemaining;if(null!=d){var e;e=0>=d?this.homeGameState:null,this.actionHandler([new a.core.board.action.ActionTimeRemainingUpdated(this.gameState.secondsRemainingFormatted,this.gameState,null,b,e),new a.core.board.action.ActionScoreUpdated]),this.timerId=setTimeout(function(){c.countDown()},d%100+1)}},b.prototype.start=function(b){var c=this;this.actionHandler=b;var d=!0,e=function(e){var f=c.getTile(e);if(f){c.mouseDown=!0,console.log("mouse down!");var g=c.calculateSelectionStates([f.value]),h=new a.core.board.action.ActionSelectTile(f,g[0]);b([h]),d&&(c.countDown(new Date),d=!1)}},f=function(){if(c.mouseDown){c.mouseDown=!1;var d=c.actionTiles(c.gameState,c.gameState.selectedTileChain);for(var e in c.gameState.selectedTileChain){var f=c.gameState.selectedTileChain[e],g=new a.core.board.action.ActionDeselectTile(f);d.push(g)}b(d)}},g=function(d){if(c.mouseDown){var e=c.getTile(d);if(e){var f=c.gameState.selectedTileChain.indexOf(e);if(f>=0){if(f<c.gameState.selectedTileChain.length-1){for(var g=[],h=f+1;h<c.gameState.selectedTileChain.length;h++){var e=c.gameState.selectedTileChain[h],i=new a.core.board.action.ActionDeselectTile(e);g.push(i)}for(var j=[],h=0;f>=h;h++){var k=c.gameState.selectedTileChain[h];j.push(k)}for(var l=c.toValues(j),m=c.calculateSelectionStates(l),h=0;f>=h;h++){var k=j[h],n=m[h];if(n!=k.selectionState){var o=new a.core.board.action.ActionSetTileSelectionState(k,n);
g.push(o)}}b(g)}}else if(c.gameState.selectedTileChain.length>0){var p=c.gameState.selectedTileChain[c.gameState.selectedTileChain.length-1];if(null!=p&&(p.position.x==e.position.x&&(p.position.y==e.position.y-1||p.position.y==e.position.y+1)||p.position.y==e.position.y&&(p.position.x==e.position.x-1||p.position.x==e.position.x+1))){var j=[];for(var q in c.gameState.selectedTileChain){var k=c.gameState.selectedTileChain[q];j.push(k)}j.push(e);for(var l=c.toValues(j),m=c.calculateSelectionStates(l),i=new a.core.board.action.ActionSelectTile(e,m[m.length-1]),g=[i],h=0;h<j.length-1;h++){var k=j[h],n=m[h];if(n!=k.selectionState){var o=new a.core.board.action.ActionSetTileSelectionState(k,n);g.push(o)}}b(g)}}}}};this.div.onmousedown=e,this.div.onmouseup=f,this.div.onmousemove=g,this.touchStartListener=function(a){e(a.touches[0]),a.preventDefault()},this.touchMoveListener=function(a){g(a.touches[0]),a.preventDefault()},this.touchEndListener=function(a){f(),a.preventDefault()},this.div.addEventListener("touchstart",this.touchStartListener),this.div.addEventListener("touchmove",this.touchMoveListener),this.div.addEventListener("touchend",this.touchEndListener)},b.prototype.stop=function(){this.div.onmousedown=null,this.div.onmouseup=null,this.div.onmousemove=null,this.div.removeEventListener("touchstart",this.touchStartListener),this.div.removeEventListener("touchmove",this.touchMoveListener),this.div.removeEventListener("touchend",this.touchEndListener),null!=this.timerId&&(clearTimeout(this.timerId),this.timerId=null)},b.prototype.getTile=function(a){var b,c=a.clientX,d=a.clientY-this.headerHeight,e=this.gameState.board.tileWidth*this.gameState.board.tilesAcross,f=this.gameState.board.tileHeight*this.gameState.board.tilesDown;if(e>c&&f>d){var g=Math.floor(c/this.gameState.board.tileWidth),h=Math.floor(d/this.gameState.board.tileHeight);b=this.gameState.board.tiles[g][h]}else b=null;return b},b.prototype.calculateSelectionStates=function(a){var b=[],c=[];if(this.calculateSelectionStates2(a,b,c),c.length>0)for(var d=c[0].quantity,e=1;e<c.length;e++){for(var f=c[e],g=0;g<f.quantity;g++){var h=b[d+g];2==h&&(b[d+g]=3)}d+=f.quantity}var i;for(var j in a)b.push(i=4);return b},b.prototype.calculateSelectionStates2=function(a,b,c){var d;if(a.length>0){var e,f,g=a.splice(0,1),h=g[0],i=h.numberOfParams;if(i>c.length)e=1,f=!1;else{var j=c.splice(c.length-i),k=[],l=1;for(var m in j){var n=j[m];l+=n.quantity,k.push(n.value)}var o=h.eval(k);c.push({value:o,quantity:l}),e=2,f=h.evalReturnsNumber}b.push(e),d=f?this.calculateSelectionStates2(a,b,c):!0}else d=!1;return d},b.prototype.eval=function(a,b){if(null==b&&(b=[]),a.length>0){var c=a.splice(0,1),d=c[0],e=d.numberOfParams;if(e>b.length)throw"not enough params";var f=b.splice(b.length-e),g=d.eval(f);return b.push(g),this.eval(a,b)}if(1==b.length)return b[0];throw"too many results"},b.prototype.toValues=function(a){var b=[];for(var c in a){var d=a[c];b.push(d.value)}return b},b.prototype.actionTiles=function(b,c){var d=[];try{var e=this.toValues(c),f=this.eval(e);if(e.length>0)throw"too long!";for(var g in c){var h=c[g],i=new a.core.board.action.ActionDestroyTile(h);d.push(i)}var j=[];if(null!=f){var k=c[c.length-1].value.terminate(c,this.gameState,f);for(var g in k){var i=k[g];if(i instanceof a.core.board.action.ActionCreateTile){var l=i;j.push(l.tile)}d.push(i)}}var m,n=0;b.replaceTiles&&(m=b.tileSource.replace(b.board,c));for(var o=0;o<this.gameState.board.tilesAcross;o++){for(var p=0,q=this.gameState.board.tilesDown;q>0;){q--;var h=this.gameState.board.tiles[o][q];if(null!=h){var r=c.indexOf(h);if(r>=0){var s=null;for(var g in j){var t=j[g];if(t.position.x==o&&t.position.y==q){s=g;break}}null!=s?h=j[s]:(p++,h=null)}if(null!=h&&p>0){var i=new a.core.board.action.ActionDropTile(h,o,q,q+p);d.push(i)}}}if(b.replaceTiles)for(var u=0;p>u;u++){var h=m[n];n++;var i=new a.core.board.action.ActionDropTile(h,o,u-p,u);d.push(i)}}d.push(new a.core.board.action.ActionScoreUpdated);var v=Math.min(this.extols.length-1,Math.max(0,c.length-3)),w=this.extols[v];setTimeout(function(){w.play()},500*Math.random()),this.claim.play()}catch(x){this.invalid.play()}return d},b}();b.BoardGameStateActionSource=c}(b.board||(b.board={}));b.board}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(b){function c(a,c,d,e,f,g,h,i){b.call(this,a,c,d),this.headerHeight=e,this.homeGameState=f,this.extols=g,this.claim=h,this.invalid=i}return __extends(c,b),c.prototype.render=function(c,d){return b.prototype.render.call(this,c,d),new a.core.render.board.BoardGameStateActionSource(c,this.homeGameState,d,this.headerHeight,this.extols,this.claim,this.invalid)},c.prototype.doRender=function(a,c,d){var e=a,f=e.board,g=f.tilesAcross*f.tileWidth,h=f.tilesDown*f.tileHeight;d.boardWidth=g,d.boardHeight=h,d.tileWidth=f.tileWidth,d.tileHeight=f.tileHeight,b.prototype.doRender.call(this,a,c,d)},c}(a.core.render.HandlebarsGameStateRenderer);b.BoardGameStateRenderer=c}(b.board||(b.board={}));b.board}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(b){function c(a,c,d,e){b.call(this,a,"opacity","0","1","",e),this.tileTemplate=c,this.tileColor=d}return __extends(c,b),c.prototype.findOrCreateTarget=function(b,c){var d=c,e=b,f=d.board,g=e.tile,h=g.id,i=this.tileTemplate({tile:g,gameState:c,tileColor:this.tileColor}),j=a.core.render.HandlebarsSVGAnimationActionRenderer.parseSVG(i,h)[0],k=document.getElementById(f.id+"-tiles");return k.appendChild(j),j},c}(a.core.render.HandlebarsSVGAnimationAttributeActionRenderer);b.HandlebarsSVGAnimationActionCreateTileRenderer=c}(b.board||(b.board={}));b.board}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(b){function c(a,c,d,e,f){b.call(this,a,f),this.tileTemplate=c,this.tileColor=d,this.soundEffect=e}return __extends(c,b),c.prototype.setToFinalState=function(a,b,c){var d=b,e=a,f=d.board,g=e.column*f.tileWidth,h=e.toRow*f.tileHeight;c.setAttribute("transform","translate("+g+","+h+")")},c.prototype.onCompletion=function(){this.soundEffect.play()},c.prototype.findOrCreateTarget=function(b,c){var d=c,e=b,f=d.board,g=e.tile,h=g.id,i=document.getElementById(h);if(!i){var j=this.tileTemplate({tile:g,gameState:c,tileColor:this.tileColor});i=a.core.render.HandlebarsSVGAnimationActionRenderer.parseSVG(j,h)[0];var k=document.getElementById(f.id+"-tiles"),l=k.firstChild;l?k.insertBefore(i,l):k.appendChild(i)}return i},c}(a.core.render.HandlebarsSVGAnimationActionRenderer);b.HandlebarsSVGAnimationActionDropTileRenderer=c}(b.board||(b.board={}));b.board}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(b,c,d,e,f,g,h,i){a.call(this,b,i),this.tileColor=c,this.validTileColor=d,this.invalidTileColor=e,this.extraneousTileColor=f,this.badParameterTileColor=g,this.idPostfix=h}return __extends(b,a),b.prototype.adjustParams=function(a,b,c){var d=a,e=d.originalSelectionState,f=d.newSelectionState,g=this.getColor(e),h=this.getColor(f);c.from=g,c.to=h,c.attributeName="fill"},b.prototype.getColor=function(a){var b;return b=2==a?this.validTileColor:1==a?this.invalidTileColor:3==a?this.extraneousTileColor:4==a?this.badParameterTileColor:this.tileColor},b.prototype.setToFinalState=function(a,b,c){var d=a,e=this.getColor(d.newSelectionState);c.setAttribute("fill",e)},b.prototype.findOrCreateTarget=function(a,b){var c=b,d=(c.board,a.getPrimaryId()+this.idPostfix),e=document.getElementById(d);return e},b}(a.core.render.HandlebarsSVGAnimationActionRenderer);b.HandlebarsSVGAnimationActionSetTileSelectionStateRenderer=c}(b.board||(b.board={}));b.board}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(){function b(a,b){this.gameState=a,this.div=b}return b.prototype.start=function(b){var c=this;for(var d in this.gameState.levels){var e=function(){var e=c.gameState.levels[d],f=document.getElementById(e.id);f.onclick=function(){var c=[new a.core.home.action.ActionLevelSelect(e)];b(c)}};e()}},b.prototype.stop=function(){},b}();b.HomeGameStateActionSource=c}(b.home||(b.home={}));b.home}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));var ct;!function(a){!function(b){!function(b){!function(b){var c=function(b){function c(a,c,d,e,f){b.call(this,a,c,d),this.windowWidth=e,this.windowHeight=f}return __extends(c,b),c.prototype.render=function(c,d){b.prototype.render.call(this,c,d);var e=c;return new a.core.render.home.HomeGameStateActionSource(e,d)},c.prototype.doRender=function(a,c,d){var e=a,f=Math.max(2,Math.floor(this.windowWidth/300)),g=this.windowWidth/(f+1),h=(this.windowWidth-g*f)/(f+1),i=Math.min(g,(this.windowHeight-h)/(2*Math.ceil(e.levels.length/f)));for(var j in e.levels){var k=Math.floor(j/f),l=j%f,m=h*(l+1)+l*g,n=h*(k+1)+k*i,o=e.levels[j];o.position.x=m,o.position.y=n}d.windowWidth=this.windowWidth,d.windowHeight=this.windowHeight,d.selectionWidth=g,d.selectionHeight=i,d.selectionWidthDiv2=g/2,d.selectionHeightDiv2=i/2,d.fontSize=g/10,b.prototype.doRender.call(this,a,c,d)},c}(a.core.render.HandlebarsGameStateRenderer);b.HomeGameStateRenderer=c}(b.home||(b.home={}));b.home}(b.render||(b.render={}));b.render}(a.core||(a.core={}));a.core}(ct||(ct={}));